"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r=e(require("through2")),t=e(require("plugin-error")),n=e(require("glob")),s=e(require("purgecss"));module.exports=function(e){return r.obj((async function(r,c,u){if(r.isNull())return u(null,r);if(r.isBuffer())try{const t={...e,content:(o=e.content,o.reduce((e,r)=>[...e,...n.sync(r)],[])),css:[{raw:r.contents.toString()}],stdin:!0},c=(await(new s).purge(t))[0],i=t.rejected&&c.rejected?c.rejected.join(" {}\n")+" {}":c.css;r.contents=Buffer.from(i,"utf-8"),u(null,r)}catch(e){this.emit("error",new t("gulp-purgecss",e.message))}var o;if(r.isStream()){const n=r;let c="";n.on("readable",e=>{c+=e.read().toString()}).on("end",async()=>{try{const t={...e,css:[c]},o=(await(new s).purge(t))[0],i=t.rejected&&o.rejected?o.rejected.join(" {}\n")+" {}":o.css;n.contents=Buffer.from(i,"utf-8"),u(null,r)}catch(e){this.emit("error",new t("gulp-purgecss",e.message))}})}}))};
